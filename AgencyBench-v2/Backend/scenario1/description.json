{
  "subtask_count": 5,
  "subtask1": "Query:\nBuild the baseline CLI login/registration layer for the Advanced C++ Console Chat System.\n- Environment: start from an empty directory containing `src/`, `include/`, `data/`, `logs/`, and a root `Makefile`. All compilations must use `g++ -std=c++17` and place the executable at `./bin/chat_app`.\n- Behavior: running `make task1 && ./bin/chat_app` must show a banner `=== Chat App v1.0.0 ===` plus a main menu with options `[1] Register`, `[2] Login`, `[3] Exit`. Invalid choices must print `Invalid choice` and reprompt immediately.\n- Registration: prompt exactly `Username: ` then `Password: ` (twice), reject duplicates, hash with SHA-256 + salt, and append to `data/users.json`.\n- Login: prompt exactly `Username: ` then `Password: `, verify credentials, print `Welcome <username>` on success, and persist session.\n- Tooling: expose `./bin/chat_app --version` that prints exactly `1.0.0` and exits 0.\n- Final goal: demonstrate in `logs/task1_demo.txt` that a new account can be registered, the program restarted, and the same account logged in again.\nDeliverables:\n- `Makefile`: Targets `task1`, `run_task1`, and `clean`. Compiles source to `./bin/chat_app`.\n- `src/main.cpp` & `src/auth.cpp`: Implements the menu loop using strict prompts (`Action: `, `Username: `, `Password: `).\n- `data/users.json`: Initialized as `[]` if empty. Valid entry: `{\"username\":\"...\",\"salt\":\"...\",\"hash\":\"...\"}`.\n- `logs/session_state.json`: Single object `{\"last_user\": \"<username>\"}`.\nRubric:\n- Build success (Score_B): run `make task1` then `./bin/chat_app --version`. Score_B=1 if output is exactly `1.0.0` and exit code is 0.\n- Persistence verification (Score_P): Register `user_task1`/`Secr3t!`. Restart. Verify `data/users.json` contains a valid JSON object where `hash` is a 64-char hex string != `Secr3t!` and `logs/session_state.json` records `last_user` as `user_task1`. Score_P=1 on match.\n- Menu semantics (Score_M): Automation script waits for `Action: `, inputs `1`; waits for `Username: `, inputs name. Score_M=1 if prompts match exactly and flow completes without timeout.\n- Final numeric grade = round(10 * (0.3*Score_B + 0.5*Score_P + 0.2*Score_M)).",
  "subtask2": "Query:\nExtend subtask1 by adding friend management while keeping all prior functionality.\n- Environment: continue using the same tree; introduce `src/friends.cpp` (with `include/friends.hpp`) plus a persisted store `data/friends_<username>.json`.\n- Behavior: once logged in, the main menu options must be `[A] Add Friend`, `[R] Remove Friend`, `[L] List Friends`, `[C] Choose Friend`, `[Q] Logout`. Prompt: `Action: `.\n- Persistence: friend data must survive restarts. File format: JSON Array of `{\"user\": \"string\", \"status\": \"online|offline\"}`.\n- Chat entry: selecting `[C]` followed by friend ID must show header `--- Chat with <friend> ---` and accept `/back` to return.\n- Tooling: expose `./bin/chat_app --selftest friend-menu` that prints compact JSON `{\"user\": \"...\", \"friends\": [...]}` matching persisted data, then exits 0.\n- Final goal: `logs/task2_demo.txt` demonstrating adding/listing/removing friends and restart persistence.\nDeliverables:\n- Updated `Makefile` (target `task2`) building auth + friends modules.\n- `src/friends.cpp`: Implements CRUD. List output format must be: `  - <username> [<status>]`.\n- `data/friends_<user>.json`: Valid JSON array. Status defaults to `offline`.\n- `logs/task2_demo.txt`: Capture of the session.\nRubric:\n- Build success (Score_B2): `make task2` then `./bin/chat_app --selftest friend-menu` exits 0. Score_B2=1 on success.\n- Friend persistence (Score_F): Log in as `user_task2`, add `alice`, restart, log in. Check `data/friends_user_task2.json` for `{\"user\": \"alice\"}`. Score_F=1 if present.\n- Status rendering (Score_S): In-app `[L]` command output must match regex `\\s+-\\s+\\w+\\s+\\[(online|offline)\\]`. Score_S=1 if match.\n- Chat entry hook (Score_C): Entering chat mode displays `--- Chat with ... ---` exactly. Score_C=1 if string matches.\n- Final numeric grade = round(10 * (0.25*Score_B2 + 0.35*Score_F + 0.2*Score_S + 0.2*Score_C)).",
  "subtask3": "Query:\nImplement single-friend chat plus history storage on top of subtask2.\n- Environment: reuse prior modules and add `src/chat.cpp`, `include/chat.hpp`.\n- Behavior: inside chat, user prompt is `> `. Commands: `/history <page>` (Page 1 = newest 10), `/clear`, `/exit`.\n- Auto replies: load `data/scripts/bot_replies.json`. Reply immediately after user input. Loop sequentially.\n- History persistence: store transcripts at `data/history/<user>/<friend>.log`. Format: `ISO8601 | sender | text`.\n- Tooling: expose `./bin/chat_app --selftest chat-loop` that simulates 3 turns (User-Bot-User) and emits JSON log `{ \"messages\": [...] }`.\n- Final goal: `logs/task3_demo.txt` capture showing message exchange and `/history 1` and `/history 2` outputs to prove pagination.\nDeliverables:\n- Updated `Makefile` (target `task3`).\n- `data/scripts/bot_replies.json`: Array of strings.\n- `data/history/`: Log files. Line format strict: `YYYY-MM-DDTHH:MM:SS | <sender> | <text>`.\n- `logs/task3_demo.txt`: Transcript proving history retention.\nRubric:\n- Build success (Score_B3): `make task3` and selftest exit 0. Score_B3=1 if pass.\n- Live chat flow (Score_CF): Script sends 3 msgs. Expects output pattern: `> ... \n[Bot] ... \n> ...`. Score_CF=1 if strictly alternating.\n- History pagination (Score_HP): `/history 1` shows lines 1-10 (newest). `/history 2` shows 11-20. Score_HP=1 if boundaries correct.\n- Persistence check (Score_HS): Verify log file content matches format `^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2} \\| .* \\| .*$`. Score_HS=1 if regex passes.\n- Final numeric grade = round(10 * (0.2*Score_B3 + 0.35*Score_CF + 0.25*Score_HP + 0.2*Score_HS)).",
  "subtask4": "Query:\nAdd friend aliases plus a fuzzy global chat history search layer.\n- Environment: include `src/alias.cpp`, `src/search.cpp`. Persist aliases in `data/aliases_<user>.json`.\n- Alias feature: `set-alias <friend> <alias>` in friend menu. Display `<alias>` in headers/lists/history. JSON Map format: `{\"friend\": \"alias\"}`.\n- Search feature: `/search <keyword>` in main menu. Scans all logs case-insensitive. Output format: `[<friend>] <date> | ...[[match]]...`.\n- Performance: Search response <1s.\n- Tooling: expose `./bin/chat_app --selftest alias-search` printing JSON `{ \"aliases\": [...], \"searchResults\": [...] }`.\n- Final goal: `logs/task4_demo.txt` shows alias overriding username and search finding `Hello` in `hello`.\nDeliverables:\n- Updated `Makefile` (target `task4`).\n- Source files for Alias/Search.\n- `logs/task4_demo.txt`: Captured search session with highlighting.\nRubric:\n- Build success (Score_B4): `make task4` and selftest exit 0. Score_B4=1.\n- Alias persistence (Score_AP): Set alias `Bob -> Boss`. Restart. Friend list must show `Boss [status]`. Score_AP=1 if consistent.\n- Search accuracy (Score_SA): `/search HEL` matches `hello` and `SHELL`. Score_SA=1 if all hits returned.\n- Highlight fidelity (Score_HF): Search output snippet must contain `[[...]]` around the matched keyword string. Score_HF=1 if formatting matches.\n- Final numeric grade = round(10 * (0.2*Score_B4 + 0.35*Score_AP + 0.35*Score_SA + 0.1*Score_HF)).",
  "subtask5": "Query:\nIntroduce concurrent chat simulation plus message consistency guarantees.\n- Environment: add `src/concurrency.cpp` with `std::thread`.\n- Behavior: Main thread blocks on UI (`std::cin`). Background threads (1 per friend) push msgs to `ThreadSafeQueue` every 3-6s.\n- Display: Main loop checks queue. If msg exists, print `[<friend>] <msg>` and **reprint input prompt** `> ` to maintain UI sanity.\n- Safety: Queue uses `mutex`+`cond_var`. File writes use `fsync`/`endl` to prevent partial logs.\n- Tooling: `./bin/chat_app --selftest concurrency` runs 5s without UI, prints `{\"processed\": N}`.\n- Final goal: `logs/task5_demo.txt` shows auto-messages appearing while user types.\nDeliverables:\n- `Makefile` (target `task5`) linking `-pthread`.\n- `tests/test_queue.cpp`: Unit test for FIFO/Thread-safety.\n- `logs/task5_demo.txt`: Session log.\nRubric:\n- Build success (Score_B5): `make task5` and selftest exit 0. Score_B5=1.\n- Thread simulation (Score_TS): Idle for 20s. Expect >=2 auto messages per friend in stdout. Score_TS=1 if observed.\n- Queue integrity (Score_QI): `make test_queue` compiles and runs assertions (push/pop order). Score_QI=1 if pass.\n- History consistency (Score_HC): Force-kill (`kill -9`) app during chat. Restart. History log must not have partial lines or duplicate timestamps. Score_HC=1 if valid.\n- Final numeric grade = round(10 * (0.2*Score_B5 + 0.35*Score_TS + 0.25*Score_QI + 0.2*Score_HC))."
}
